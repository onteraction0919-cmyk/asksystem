<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>질문 등록</title>
  <style>
    :root{
      --bg:#0f1020;        /* 딥 네이비 */
      --card:#181a2e;      /* 카드 배경 */
      --text:#eef2ff;      /* 본문 */
      --muted:#a3aed0;     /* 보조 텍스트 */
      --accent:#7c5cff;    /* 포인트 */
      --accent-2:#5ad0ff;  /* 포인트 2 */
      --ok:#20c997;
      --danger:#ff6b6b;
    }
    html,body{height:100%}
    body{
      margin:0; background:
        radial-gradient(1200px 800px at 10% -10%, #1a1b33 0%, rgba(26,27,51,0) 60%),
        radial-gradient(900px 600px at 110% 10%, #101337 0%, rgba(16,19,55,0) 60%),
        var(--bg);
      color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
    }
    .wrap{
      min-height:100%; display:flex; flex-direction:column;
    }
    header{
      position:sticky; top:0; z-index:5;
      backdrop-filter:saturate(140%) blur(8px);
      background:linear-gradient(90deg, rgba(10,10,24,.6), rgba(10,10,24,.25));
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .nav{
      max-width:1100px; margin:0 auto; padding:16px 20px;
      display:flex; align-items:center; gap:16px;
    }
    .logo{
      display:flex; align-items:center; gap:12px;
    }
    .logo img{height:28px; width:auto; object-fit:contain}
    .brand{font-weight:700; letter-spacing:.2px}
    .hint{color:var(--muted); font-size:14px}
    main{flex:1}
    .container{
      max-width:1100px; margin:32px auto; padding:0 20px;
      display:grid; grid-template-columns:1fr; gap:18px;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:18px; padding:20px;
      box-shadow:0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.05);
    }
    .title{font-size:18px; font-weight:700; margin:2px 0 14px}
    .input{
      width:100%; min-height:150px; resize:vertical;
      font-size:18px; line-height:1.6; color:var(--text);
      background:#0f1125; border:1px solid rgba(255,255,255,.12);
      border-radius:14px; padding:16px 18px; outline:none;
      transition:.15s border-color, .15s box-shadow;
    }
    .input:focus{border-color:var(--accent); box-shadow:0 0 0 4px rgba(124,92,255,.15)}
    .row{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-top:12px}
    .counter{color:var(--muted); font-size:14px}
    .btn{
      appearance:none; border:none; cursor:pointer;
      padding:12px 18px; border-radius:12px; font-weight:700;
      color:#0b0c14; background:linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow:0 12px 30px rgba(92,64,250,.35);
      transition:.15s transform,.15s filter;
    }
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{filter:grayscale(.5); opacity:.7; cursor:not-allowed}
    .tip{color:var(--muted); font-size:13px}
    .toast{
      position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
      background:#0f1125; color:var(--text);
      border:1px solid rgba(255,255,255,.12);
      padding:12px 16px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.35);
      opacity:0; pointer-events:none; transition:.2s opacity, .2s transform;
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(-4px)}
    footer{color:var(--muted); font-size:12px; text-align:center; padding:28px 0 40px}
    @media (min-width:920px){
      .container{grid-template-columns:2fr 1fr}
      .input{min-height:220px; font-size:20px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="nav">
        <div class="logo">
          <img src="/static/logo.png" alt="brand" />
          <div class="brand">ASK SYSTEM</div>
        </div>
        <div class="hint">행사 중 실시간으로 질문을 남겨 주세요.</div>
      </div>
    </header>

    <main>
      <div class="container">
        <!-- 입력 카드 -->
        <section class="card">
          <div class="title">질문 작성</div>
          <textarea id="q" class="input" maxlength="800" placeholder="예) 교수님, PCSK9 억제제 치료를 중단하는 주요 이유는 무엇인가요?"></textarea>
          <div class="row">
            <div class="tip">개인정보/실명 언급 없이, 핵심만 간결하게 부탁드립니다.</div>
            <div class="counter"><span id="len">0</span>/800</div>
          </div>
          <div class="row" style="justify-content:flex-end; margin-top:14px">
            <button id="send" class="btn">질문 올리기</button>
          </div>
        </section>

        <!-- 가이드 카드 -->
        <aside class="card">
          <div class="title">안내</div>
          <div class="tip" style="line-height:1.7">
            • 모든 질문은 운영팀 검토 후 화면에 노출됩니다.<br/>
            • 동일 질문은 한 번만 올려 주세요.<br/>
            • 네트워크가 불안정하면 1~2초 후 자동 재시도됩니다.
          </div>
        </aside>
      </div>
    </main>

    <footer>© <span id="yy"></span> Onteraction · Powered by Render</footer>
  </div>

  <div id="toast" class="toast">전송되었습니다 ✅</div>

  <script>
    const ta  = document.getElementById('q');
    const len = document.getElementById('len');
    const btn = document.getElementById('send');
    const toast = document.getElementById('toast');
    const YY = document.getElementById('yy');
    YY.textContent = new Date().getFullYear();

    const updateLen = () => { len.textContent = ta.value.length; };
    ta.addEventListener('input', updateLen); updateLen();

    function showToast(text, ok=true){
      toast.textContent = text;
      toast.style.borderColor = ok ? 'rgba(32,201,151,.4)' : 'rgba(255,107,107,.5)';
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'),1700);
    }

    async function send(){
      const text = ta.value.trim();
      if(!text){ showToast('내용을 입력해 주세요', false); return; }
      btn.disabled = true;
      try{
        const res = await fetch('/api/questions', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({ text })
        });
        if(!res.ok) throw new Error('전송 실패');
        ta.value = ''; updateLen();
        showToast('전송되었습니다 ✅', true);
      }catch(e){
        showToast('네트워크 오류. 잠시 후 다시 시도', false);
      }finally{
        btn.disabled = false;
      }
    }
    btn.addEventListener('click', send);
    ta.addEventListener('keydown', (e)=>{
      if((e.metaKey||e.ctrlKey) && e.key.toLowerCase()==='enter'){ send(); }
    });
  </script>
</body>
</html>
