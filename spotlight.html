<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>방송 질문 자막</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      /* 배경 / 카드 색상 */
      --page-bg: #ffffff;           /* 전체 배경: 흰색 */
      --card-bg: #eef0f3;           /* 박스: 아주 연한 회색 */
      --text:    #171a1f;           /* 본문 글자색 */
      --muted:   #7b8495;
      --radius:  28px;

      /* 기본 글자 크기: 너무 커지지 않도록 상한을 둠 */
      --fs: clamp(22px, 2.2vw, 38px);   /* 필요 시 URL로 override 가능: ?fs=34px 또는 ?fs=2vw */
      --lh: 1.35;                       /* 줄간격 */
      --padY: clamp(22px, 3.2vw, 48px); /* 상하 패딩 */
      --padX: clamp(26px, 4.2vw, 64px); /* 좌우 패딩 */
      --maxW: 1200px;                   /* 박스 최대 너비 */
    }

    html, body {
      height: 100%;
      margin: 0;
      background: var(--page-bg);
      color: var(--text);
      font-family: Pretendard, "Noto Sans KR", -apple-system, BlinkMacSystemFont,
        "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple SD Gothic Neo", "Malgun Gothic", Dotum, sans-serif;
    }

    .stage {
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 6vh 4vw;
    }

    .bubble {
      width: min(86vw, var(--maxW));
      background: var(--card-bg);
      border-radius: var(--radius);
      border: 1px solid rgba(0,0,0,0.06);
      box-shadow: 0 10px 36px rgba(0,0,0,0.08);
      padding: var(--padY) var(--padX);
    }

    .q {
      font-size: var(--fs);
      line-height: var(--lh);
      font-weight: 800;
      text-align: center;
      word-break: keep-all;
      white-space: pre-wrap;
    }

    /* 로고(오른쪽 하단). ?logo=0로 숨김 가능 */
    .logo {
      position: fixed;
      right: 26px;
      bottom: 20px;
      opacity: .9;
      user-select: none;
      pointer-events: none;
      filter: grayscale(0);
    }
    .logo img { height: 28px; }

    /* 매우 작은 화면 보정 */
    @media (max-width: 600px){
      :root { --fs: clamp(18px, 4.2vw, 26px); }
      .logo img { height: 22px; }
    }
  </style>
</head>
<body>
  <main class="stage">
    <section class="bubble">
      <div id="q" class="q">방송 대기중입니다…</div>
    </section>
  </main>

  <div class="logo" id="logo">
    <!-- 로고 파일 경로를 자신의 파일로 교체 가능 (static 폴더에 두면 /static/… 경로 사용) -->
    <img src="/static/logo-sanofi.svg" alt="logo" />
  </div>

  <script>
    // ------- 옵션: URL 파라미터로 글자크기/로고/여백 미세 조정 -------
    const p = new URLSearchParams(location.search);
    // 글자 크기 강제 지정 (예: ?fs=34px 또는 ?fs=2.4vw)
    if (p.get('fs')) document.documentElement.style.setProperty('--fs', p.get('fs'));
    // 박스 최대너비 (예: ?max=1000)
    if (p.get('max')) document.documentElement.style.setProperty('--maxW', p.get('max') + 'px');
    // 로고 숨김 (예: ?logo=0)
    if (p.get('logo') === '0') document.getElementById('logo').style.display = 'none';
    // 상/하/좌/우 패딩 (예: ?py=40&px=60)
    if (p.get('py')) document.documentElement.style.setProperty('--padY', p.get('py') + 'px');
    if (p.get('px')) document.documentElement.style.setProperty('--padX', p.get('px') + 'px');

    // ------- 데이터 폴링: 현재 활성화된 질문을 가져와 표시 -------
    const $q = document.getElementById('q');
    async function loadActive() {
      try {
        const r = await fetch('/api/active', { cache: 'no-store' });
        const j = await r.json();
        $q.textContent = j?.text ? j.text : '방송 대기중입니다…';
      } catch (e) {
        $q.textContent = '네트워크 오류…';
      }
    }

    loadActive();
    setInterval(loadActive, 1500); // 1.5초마다 갱신
  </script>
</body>
</html>
